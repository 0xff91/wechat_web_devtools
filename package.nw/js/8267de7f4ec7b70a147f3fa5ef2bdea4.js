'use strict';var _extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a};!function(require,directRequire){function a(a,b){let c=new Error(a);throw c.code=b,c}function b(b,c){'string'!=l.getType(b)&&a(m.config.JSON_CONTENT_SHOULD_BE.format([`${c}`,'string']),v.APP_JSON_CONTENT_ERR),0<=b.indexOf('\\')&&a(m.config.JSON_SHOULD_NOT_CONTAIN.format([`${c}`,'\\']),v.APP_JSON_CONTENT_ERR),0==b.indexOf('.')&&a(m.config.JSON_SHOULD_NOT_START_WITH.format([`${c}`,'.']),v.APP_JSON_CONTENT_ERR),0==b.indexOf('/')&&a(m.config.JSON_SHOULD_NOT_START_WITH.format([`${c}`,'/']),v.APP_JSON_CONTENT_ERR)}function c(a,b){function c(b,c){return'object'==l.getType(b)?'string'==l.getType(b.provider)?'string'==l.getType(b.version)?a.compileType!=n.plugin&&'dev'==b.version?void d.push(m.config.JSON_CONTENT_SHOULD_NOT_BE.format([`${c}.version`,'dev'])+'\n'+m.config.PLEASE_CHOOSE_PLUGIN_MODE):a.compileType==n.plugin&&'dev'==b.version&&b.provider!=a.appid?void d.push(m.config.JSON_CONTENT_SHOULD_BE.format([`${c}.provider`,a.appid])):'dev'==b.version||/^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$/.test(b.version)||void d.push(m.config.JSON_CONTENT_SHOULD_BE.format([`${c}.version`,m.config.TRIPLE_NUMBER_DOT])):void d.push(m.config.JSON_CONTENT_SHOULD_BE.format([`${c}.version`,'string'])):void d.push(m.config.JSON_CONTENT_SHOULD_BE.format([`${c}.provider`,'string'])):void d.push(m.config.JSON_CONTENT_SHOULD_BE.format([`${c}`,'object']))}const d=[],e=b.plugins;if(!e)return d;if('object'!=l.getType(e))return d.push(m.config.JSON_CONTENT_SHOULD_BE.format(['plugins','object'])),d;const f={};for(const g in e){const a=e[g];c(a,`plugins.${g}`)&&(f[a.provider]?d.push(m.config.PLUGINS_MULTI_PROVIDER.format(a.provider)):f[a.provider]={provider:a.provider,version:a.version,alias:g})}if(b.subPackages&&b.subPackages.forEach((a,b)=>{if(a.plugins)for(const g in a.plugins){const h=a.plugins[g];(e[g]&&d.push(m.config.JSON_PLUGIN_SHOULD_NOT_IN_SUBPACKAGE.format([`plugins ${g}`,`subPackages[${b}]`])),!!c(h,`subPackages[${b}].plugins.${g}`))&&(f[h.provider]?d.push(`subPackages[${b}].plugins['${g}'].provider ${m.config.ALREADY_EXISTS}`):f[h.provider]={provider:h.provider,version:h.version,alias:h})}}),0<d.length){const a=new Error(d.join('\n'));throw a.code=v.APP_JSON_CONTENT_ERR,a}}function d(c,d){let e='subPackages';d.subpackages&&(e='subpackages',d.subPackages=d.subpackages,delete d.subpackages);const f=d.pages||[];let g=!1;if(d.subPackages){'array'!=l.getType(d.subPackages)&&a(m.config.JSON_CONTENT_SHOULD_BE.format([e,'array']),v.APP_JSON_CONTENT_ERR);const h={},i={},n=[];d.subPackages.forEach((a,o)=>{if(b(a.root,`${e}[${o}].root`),a.root===q.MINI_PROGRAM_MAIN_PACKAGE_ROOT)return void n.push(m.config.JSON_CONTENT_SHOULD_NOT_BE.format([`${e}[${o}].root`,q.MINI_PROGRAM_MAIN_PACKAGE_ROOT]));if(a.name){if('string'!==l.getType(a.name))return void n.push(m.config.JSON_CONTENT_SHOULD_BE.format([`${e}[${o}].name`,'string']));if(a.name===q.MINI_PROGRAM_MAIN_PACKAGE_ROOT)return void n.push(m.config.JSON_CONTENT_SHOULD_NOT_BE.format([`${e}[${o}].name`,q.MINI_PROGRAM_MAIN_PACKAGE_ROOT]));if(i[a.name])return void n.push(m.config.JSON_SUBPACKAGE_EXIST.format([`${e}[${o}].name`]));i[a.name]=!0}if(a.root=l.normalizePath(a.root+'/'),h[a.root])return void n.push(m.config.JSON_SUBPACKAGE_EXIST.format([`${e}[${o}].root`]));if(h[a.root]=!0,!k.existsSync(j.join(c,a.root)))return void n.push(m.config.JSON_CONTENT_SHOULD_BE.format([`${e}[${o}].root`,m.config.DIRECTORY]));const p=k.statSync(j.join(c,a.root));if(!p.isDirectory())return void n.push(m.config.JSON_CONTENT_SHOULD_BE.format([`${e}[${o}].root`,m.config.DIRECTORY]));if(f.forEach((b)=>{0==b.indexOf(a.root)&&n.push(m.config.JSON_PAGE_SHOULD_NOT_IN_SUBPACKAGE.format([`pages ${b}`,`${e}[${o}]`]))}),'array'!=l.getType(a.pages))return void n.push(m.config.JSON_CONTENT_SHOULD_BE.format([`${e}[${o}].pages`,'array']));const r={};for(let f=0,h=a.pages.length;f<h;f++){const h=a.pages[f];b(h,`${e}[${o}].pages[${f}]`);const i=l.normalizePath(j.posix.join(a.root,h));if(r[i]){n.push(m.config.JSON_PAGES_REPEAT.format([`${e}[${o}]`,h]));continue}r[i]=!0,g||i!=d.entryPagePath||(g=!0),k.existsSync(j.join(c,`${i}\.wxml`))||n.push(m.config.JSON_PAGE_WXML_NOT_EXISTS.format([`${e}[${o}]`,'pages',i])),k.existsSync(j.join(c,`${i}\.js`))||n.push(m.config.JSON_PAGE_JS_NOT_EXISTS.format([`${e}[${o}]`,'pages',i]))}}),0<n.length&&a(n.join('\n'),v.APP_JSON_CONTENT_ERR),d.subPackages.forEach((a,b)=>{let c=-1;const f='/'+a.root;if(d.subPackages.forEach((a,d)=>{if(d!=b&&a.root){const b='/'+a.root;0==f.indexOf(b)&&(c=d)}}),-1!=c)return void n.push(m.config.JSON_CONTENT_SHOULD_NOT_BE.format([`${e}[${b}].root`,`${e}[${c}].root 的子目录`]))}),0<n.length&&a(n.join('\n'),v.APP_JSON_CONTENT_ERR)}return g}function e(b){if(b.preloadRule&&b.subPackages){'object'!==l.getType(b.preloadRule)&&a(m.config.JSON_CONTENT_SHOULD_BE.format(['preloadRule','object']),v.APP_JSON_CONTENT_ERR);let c=[],d=[].concat(b.pages),e={},f={};for(let a=0,c=b.subPackages.length;a<c;a++){const c=b.subPackages[a],g=c.pages.map((a)=>{return j.posix.join(c.root,a)});e[c.root]=!0,c.name&&(f[c.name]=!0),d=d.concat(g)}for(const a in b.preloadRule){if(-1===d.indexOf(a)){c.push(m.config.NOT_FOUND.format(`preloadRule['${a}'] ${m.config.PAGE_PATH}`));continue}const g=b.preloadRule[a];if(g.network){if('string'!==l.getType(g.network)){c.push(m.config.JSON_CONTENT_SHOULD_BE.format([`preloadRule['${a}'].network`,'string']));continue}if(-1===['all','wifi'].indexOf(g.network)){c.push(m.config.JSON_CONTENT_SHOULD_BE.format([`preloadRule['${a}'].network`,'all/wifi']));continue}}if('array'!==l.getType(g.packages)){c.push(m.config.JSON_CONTENT_SHOULD_BE.format([`preloadRule['${a}'].packages`,'array']));continue}for(let b,d=0,h=g.packages.length;d<h;d++)if((b=g.packages[d],b!==q.MINI_PROGRAM_MAIN_PACKAGE_ROOT)&&!f[b]&&(b=l.normalizePath(b+'/'),!e[b])){c.push(m.config.NOT_FOUND.format(`preloadRule['${a}'].packages[${d}]: ${b}`));continue}}0<c.length&&a(c.join('\n'),v.APP_JSON_CONTENT_ERR)}}async function f(c,d){const e=await o(c),f=e.srcPath,g=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),h=_extends({},g.setting,c.runtimeAttr&&c.runtimeAttr.setting),n=d.pages,p=d.tabBar;let q=[];if(p){'array'!=l.getType(p.list)&&a(m.config.JSON_TABBAR_SHOULD_BE_LIST,v.APP_JSON_CONTENT_ERR),p.list.length<h.MinTabbarCount&&a(m.config.JSON_TABBAR_AT_LEAST.format(h.MinTabbarCount),v.APP_JSON_CONTENT_ERR),p.list.length>h.MaxTabbarCount&&a(m.config.JSON_TABBAR_AT_MOST.format(h.MaxTabbarCount),v.APP_JSON_CONTENT_ERR);for(var r=0;r<p.list.length;r++){let a=p.list[r];if('object'!=l.getType(a)){q.push(m.config.JSON_TABBAR_ITEM_OBJECT.format(r));continue}const c=a.pagePath;if(b(c,`tabBar[${r}].pagePath`),!c){q.push(m.config.JSON_TABBAR_PATH_EMPTY.format(r));continue}if(0>n.indexOf(c)){q.push(`tabBar[${r}].pagePath "${c}" 需在 pages 数组中`);continue}2<=c.split('?').length&&q.push(m.config.JSON_TABBAR_PATH_NOT_CONTAIN.format([r,'?'])),2<=c.split('.').length&&q.push(m.config.JSON_TABBAR_PATH_NOT_CONTAIN.format([r,'.']));let d=[];if(a.iconPath){let b=j.join(f,a.iconPath);a.iconPath=j.relative(f,b),d.push({name:'iconPath',path:b})}if(a.selectedIconPath){let b=j.join(f,a.selectedIconPath);a.selectedIconPath=j.relative(f,b),d.push({name:'selectedIconPath',path:b})}d.forEach((a)=>{if(!k.existsSync(a.path))return q.push(m.config.JSON_TABBAR_ICON_NOT_FOUND.format([r,a.name]));let b=k.statSync(a.path);if(b.isDirectory())return q.push(m.config.JSON_TABBAR_ICON_NOT_DIR.format([r,a.name]));b.size>1024*h.MaxTabbarIconSize&&q.push(m.config.JSON_TABBAR_ICON_MAX_SIZE.format([r,a.name,h.MaxTabbarIconSize]));let c=j.extname(a.path);0>u.indexOf(c)&&q.push(m.config.JSON_TABBAR_ICON_EXT.format([r,a.name,u.join('\u3001')]))})}}0<q.length&&a(q.join('\n'),v.APP_JSON_CONTENT_ERR)}async function g(b,c){const d=[];if(c.navigateToMiniProgramAppIdList){'array'!==l.getType(c.navigateToMiniProgramAppIdList)&&a(m.config.JSON_CONTENT_SHOULD_BE.format([`navigateToMiniProgramAppIdList`,'array'])),c.navigateToMiniProgramAppIdList.forEach((a,b)=>{'string'!==l.getType(a)&&d.push(m.config.JSON_CONTENT_SHOULD_BE.format([`navigateToMiniProgramAppIdList[${b}]`,'string']))});const e=b.runtimeAttr&&b.runtimeAttr.appType||t.APP_TYPE.NORMAL;if(e!==t.APP_TYPE.NATIVE){const a=b.runtimeAttr&&b.runtimeAttr.setting&&b.runtimeAttr.setting.NavigateMiniprogramLimit||t.setting.NavigateMiniprogramLimit;c.navigateToMiniProgramAppIdList.length>a&&d.push(m.config.EXCEED_LIMIT.format([`navigateToMiniProgramAppIdList`,a]))}}0<d.length&&a(d.join('\n'),v.APP_JSON_CONTENT_ERR)}async function h(h){const p=await o(h),q=p.srcPath,t=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),u='app.json';let w='',x=[];try{w=p.getFile(u)}catch(a){const b=new Error(m.config.FILE_NOT_FOUND.format(u));throw b.code=v.APP_JSON_READ_ERR,b.ext=a.toString(),b}let y={};try{y=JSON.parse(w)}catch(b){const c=r.parseJsonParseErr({data:w,error:b});a(c,v.APP_JSON_PARSE_ERR)}'string'==l.getType(y.entryPagePath)&&b(y.entryPagePath,'entryPagePath');const z=y.pages||[];('array'!=l.getType(z)||0===z.length)&&a(m.config.ENTRANCE_NOT_FOUND.format(JSON.stringify(z)),v.APP_JSON_ENTRANCE_NOT_FOUND_ERR);let A=!y.entryPagePath;const B={};for(let c=0;c<z.length;c++){const d=z[c];b(d,`pages[${c}]`),B[d]&&a(m.config.JSON_PAGES_REPEAT.format([u,d]),v.APP_JSON_PAGES_ERR),B[d]=!0,A||d!=y.entryPagePath||(A=!0),k.existsSync(j.join(q,`${d}\.wxml`))||a(m.config.JSON_PAGE_WXML_NOT_EXISTS.format([u,'pages',d]),v.APP_JSON_WXML_NOT_FOUND),k.existsSync(j.join(q,`${d}\.js`))||a(m.config.JSON_PAGE_JS_NOT_EXISTS.format([u,'pages',d]),v.APP_JSON_JS_NOT_FOUND)}await f(h,y);const C=h.compileType;if(C==n.conversation||C==n.search){const a=y.widgets;let b,c='';if(!a)b=new Error(m.config.JSON_WIDGETS_EMPTY.format('app.json'));else if('array'!=l.getType(a))b=new Error(m.config.JSON_WIDGETS_NOT_ARRAY.format('app.json'));else{const d=[];a.forEach((a,b)=>{if('object'!=l.getType(a))d.push(m.config.JSON_WIDGETS_ITEM_NOT_OBJECT.format(['app.json',b]));else if('conversation'!=a.type&&'search'!=a.type)d.push(m.config.JSON_WIDGETS_TYPE_INVALID.format(['app.json',b,'conversation\u3001search']));else if(!a.path||'string'!=l.getType(a.path))d.push(m.config.JSON_WIDGETS_PATH_NOT_FOUND.format(['app.json',b]));else if(!k.existsSync(j.join(q,a.path)))d.push(m.config.JSON_WIDGETS_PATH_NOT_FOUND.format(['app.json',b]));else{const c=k.statSync(j.join(q,a.path));c.isDirectory()?!k.existsSync(j.join(q,a.path,'widget.js'))&&d.push(m.config.JSON_WIDGETS_JS_NOT_FOUND.format(['app.json',b,'widget.js'])):d.push(m.config.JSON_WIDGETS_PATH_SHOULD_BE_DIR.format(['app.json',b]))}c||a.type!=h.compileType||(c=a.path)}),c||d.push(m.config.JSON_WIDGETS_TYPE_NOT_FOUND.format(['app.json',h.compileType])),0<d.length&&(b=new Error(d.join('\n')))}if(b)throw b.code=v.APP_JSON_CONTENT_ERR,b}const D=await i(h);if(D)for(const a in D)'extPages'!=a&&(y[a]='object'==l.getType(D[a])?Object.assign({},y[a]||{},D[a]):D[a]);const E=d(q,y);return A=A||E,A||a(m.config.JSON_ENTRY_PAGE_PATH_NOT_FOUND.format(['pages\u3001subPackages','entryPagePath']),v.APP_JSON_PAGES_ERR),c(h,y),e(y),y.window&&(x=[],['enablePullDownRefresh'].forEach((a)=>{'undefined'!=typeof y.window[a]&&'boolean'!=typeof y.window[a]&&x.push(m.config.JSON_CONTENT_SHOULD_BE.format([a,'boolean']))}),y.window.backgroundColorTop&&(y.window.backgroundColor=y.window.backgroundColorTop)),y.usingComponents&&s.checkUsingComponents(y,{msg:x,filePath:'app.json',JSON_PARSE_ERR:v.APP_JSON_PARSE_ERR}),await g(h,y),0<x.length&&a(x.join('\n'),v.APP_JSON_CONTENT_ERR),y}const j=require('path'),k=require('fs'),l=require('./84b183688a46c9e2626d3e6f83365e13.js'),m=require('./common/locales/index.js'),i=require('./551bb965e1f344281d555a429cd2140c.js'),n=require('./9fdd4ac31a05c27355910f0d74accd4c.js'),o=require('./162bf2ee28b76d3b3d95b685cede4146.js'),p=require('./2dfc6a3df6d6fc51266b293c8420e88b.js'),q=require('./56c390e04c10e91a4aa2a2c19d9a885d.js'),r=require('./6238a86bb7a55c11aa0f9eb335d0f34c.js'),s=require('./464e9598eb5c203da6b41e702e422c70.js'),t=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),u=['.png','.jpg','.jpeg'],v=require('./949d8235c744ced2a80121e4dba34c28.js');module.exports=async function(a){try{return await h(a)}catch(a){throw a.code||(a.code=v.APP_JSON_CONTENT_ERR),a}}}(require('lazyload'),require);